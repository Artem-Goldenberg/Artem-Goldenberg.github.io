{"identifier":{"url":"doc:\/\/JustText\/documentation\/JustText\/JTRealMap","interfaceLanguage":"occ"},"schemaVersion":{"major":0,"minor":3,"patch":0},"sections":[],"seeAlsoSections":[{"title":"Internal Separator Extractors","anchor":"Internal-Separator-Extractors","generated":true,"identifiers":["doc:\/\/JustText\/documentation\/JustText\/JTParensSepExtractor","doc:\/\/JustText\/documentation\/JustText\/JTSepProducerExtractor","doc:\/\/JustText\/documentation\/JustText\/JTPlainSepExtractor","doc:\/\/JustText\/documentation\/JustText\/JTCommonMap","doc:\/\/JustText\/documentation\/JustText\/JTRealMapRef"]}],"metadata":{"fragments":[{"kind":"identifier","text":"JTRealMap"}],"navigatorTitle":[{"text":"JTRealMap","kind":"identifier"}],"symbolKind":"macro","role":"symbol","externalID":"c:Sequences.h@659@macro@JTRealMap","roleHeading":"Macro","modules":[{"name":"JustText"}],"title":"JTRealMap"},"primaryContentSections":[{"declarations":[{"platforms":["macOS"],"tokens":[{"text":"#define","kind":"keyword"},{"text":" ","kind":"text"},{"kind":"identifier","text":"JTRealMap"},{"text":"(","kind":"text"},{"kind":"internalParam","text":"mapper"},{"text":", ","kind":"text"},{"text":"sep","kind":"internalParam"},{"text":", ","kind":"text"},{"text":"extractor","kind":"internalParam"},{"text":", ","kind":"text"},{"kind":"internalParam","text":"arg"},{"text":", ...)","kind":"text"}],"languages":["occ"]}],"kind":"declarations"},{"kind":"content","content":[{"anchor":"Overview","type":"heading","level":2,"text":"Overview"},{"type":"paragraph","inlineContent":[{"text":"It is so real. It was first called ","type":"text"},{"type":"codeVoice","code":"RecursiveMap"},{"type":"text","text":", but Real is cooler and shorter."},{"text":" ","type":"text"},{"text":"So all this map does is exactly what you’d expect.","type":"text"}]},{"type":"orderedList","items":[{"content":[{"inlineContent":[{"type":"text","text":"It applies our "},{"type":"codeVoice","code":"mapper"},{"text":" macro to the first argument (out of the arguments we need to process)","type":"text"}],"type":"paragraph"}]},{"content":[{"type":"paragraph","inlineContent":[{"type":"text","text":"If more arguments are left in the list, we put down our separator with the help of the "},{"code":"extractor","type":"codeVoice"},{"type":"text","text":","}]}]},{"content":[{"inlineContent":[{"type":"text","text":"After the extracted separator, we need to somehow call "},{"type":"codeVoice","code":"JTRealMap"},{"type":"text","text":" to process all other elements"}],"type":"paragraph"}]},{"content":[{"type":"paragraph","inlineContent":[{"text":"C macros can’t directly call themselves, so we use a trick I picked up from this article:","type":"text"},{"text":" ","type":"text"},{"type":"codeVoice","code":"https:\/\/www.scs.stanford.edu\/~dm\/blog\/va-opt.html"}]}]}]},{"inlineContent":[{"type":"text","text":"Idea of the trick is that we can defer the invokation of this "},{"type":"reference","isActive":true,"identifier":"doc:\/\/JustText\/documentation\/JustText\/JTRealMapRef"},{"type":"text","text":" "},{"type":"text","text":"(which would eventually give us our RealMap back) by putting "},{"identifier":"doc:\/\/JustText\/documentation\/JustText\/JTParens","isActive":true,"type":"reference"},{"text":" macro instead","type":"text"},{"text":" ","type":"text"},{"text":"of the real parentheses. So it will require an extra expansion to evaluate this thing, and that means,","type":"text"},{"type":"text","text":" "},{"type":"text","text":"when it is evaluated, all the bits and stuff for our initial "},{"type":"codeVoice","code":"JTRealMap"},{"type":"text","text":" macro will be cleared, it will be expanded again,"},{"type":"text","text":" "},{"type":"text","text":"finally creating our so desired recursion! So, because of these delayed operations, preprocessor forgets that it has"},{"type":"text","text":" "},{"type":"text","text":"already expanded our "},{"code":"JTRealMap","type":"codeVoice"},{"type":"text","text":" macro. Still don’t understand it in comlete details, stuff about replacing bits, but the"},{"text":" ","type":"text"},{"text":"basic idea is this.","type":"text"}],"type":"paragraph"},{"inlineContent":[{"type":"text","text":"Because we are just using this "},{"type":"codeVoice","code":"__VA_OPT__"},{"text":" thing, the implementation is really straightforwrad here.","type":"text"},{"type":"text","text":" "},{"text":"We don’t have to explicitly clear any bits (still not sure if it’s even possible), or try to implement this ","type":"text"},{"code":"__VA_OPT__","type":"codeVoice"},{"type":"text","text":" "},{"type":"text","text":"from scratch, which is actually not as easy as it may seem."}],"type":"paragraph"}]}],"kind":"symbol","hierarchy":{"paths":[["doc:\/\/JustText\/documentation\/JustText"]]},"abstract":[{"type":"text","text":"Actual "},{"type":"emphasis","inlineContent":[{"text":"recursivish","type":"text"}]},{"type":"text","text":" macro to map the arguments"}],"variants":[{"traits":[{"interfaceLanguage":"occ"}],"paths":["\/documentation\/justtext\/jtrealmap"]}],"references":{"doc://JustText/documentation/JustText/JTCommonMap":{"type":"topic","title":"JTCommonMap","identifier":"doc:\/\/JustText\/documentation\/JustText\/JTCommonMap","role":"symbol","url":"\/documentation\/justtext\/jtcommonmap","kind":"symbol","fragments":[{"kind":"identifier","text":"JTCommonMap"}],"abstract":[{"type":"text","text":"Lower-level mapping macro"}]},"doc://JustText/documentation/JustText/JTRealMapRef":{"identifier":"doc:\/\/JustText\/documentation\/JustText\/JTRealMapRef","fragments":[{"text":"JTRealMapRef","kind":"identifier"}],"kind":"symbol","title":"JTRealMapRef","type":"topic","abstract":[{"text":"Deferred call of ","type":"text"},{"type":"reference","identifier":"doc:\/\/JustText\/documentation\/JustText\/JTRealMap","isActive":true}],"role":"symbol","url":"\/documentation\/justtext\/jtrealmapref"},"doc://JustText/documentation/JustText/JTParensSepExtractor":{"title":"JTParensSepExtractor","abstract":[{"type":"text","text":"Unpacks the parenthesised expression"}],"role":"symbol","fragments":[{"text":"JTParensSepExtractor","kind":"identifier"}],"type":"topic","identifier":"doc:\/\/JustText\/documentation\/JustText\/JTParensSepExtractor","url":"\/documentation\/justtext\/jtparenssepextractor","kind":"symbol"},"doc://JustText/documentation/JustText/JTSepProducerExtractor":{"type":"topic","role":"symbol","url":"\/documentation\/justtext\/jtsepproducerextractor","title":"JTSepProducerExtractor","abstract":[{"text":"Calls the given ","type":"text"},{"code":"sep","type":"codeVoice"},{"text":" macro to get the separator","type":"text"}],"fragments":[{"text":"JTSepProducerExtractor","kind":"identifier"}],"kind":"symbol","identifier":"doc:\/\/JustText\/documentation\/JustText\/JTSepProducerExtractor"},"doc://JustText/documentation/JustText/JTParens":{"kind":"symbol","type":"topic","url":"\/documentation\/justtext\/jtparens","abstract":[{"text":"Again, everything here is pretty basic, so it just does what it says","type":"text"}],"role":"symbol","fragments":[{"text":"JTParens","kind":"identifier"}],"identifier":"doc:\/\/JustText\/documentation\/JustText\/JTParens","title":"JTParens"},"doc://JustText/documentation/JustText/JTRealMap":{"abstract":[{"type":"text","text":"Actual "},{"type":"emphasis","inlineContent":[{"text":"recursivish","type":"text"}]},{"type":"text","text":" macro to map the arguments"}],"type":"topic","url":"\/documentation\/justtext\/jtrealmap","kind":"symbol","role":"symbol","identifier":"doc:\/\/JustText\/documentation\/JustText\/JTRealMap","fragments":[{"text":"JTRealMap","kind":"identifier"}],"title":"JTRealMap"},"doc://JustText/documentation/JustText":{"kind":"symbol","type":"topic","abstract":[{"type":"emphasis","inlineContent":[{"text":"After all, it’s just a bunch of text","type":"text"}]}],"url":"\/documentation\/justtext","role":"collection","identifier":"doc:\/\/JustText\/documentation\/JustText","title":"JustText"},"doc://JustText/documentation/JustText/JTPlainSepExtractor":{"kind":"symbol","type":"topic","url":"\/documentation\/justtext\/jtplainsepextractor","abstract":[{"type":"text","text":"Just return the separator as is"}],"role":"symbol","fragments":[{"text":"JTPlainSepExtractor","kind":"identifier"}],"identifier":"doc:\/\/JustText\/documentation\/JustText\/JTPlainSepExtractor","title":"JTPlainSepExtractor"}}}